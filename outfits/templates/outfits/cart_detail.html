{% extends 'outfits/base.html' %}
{% load humanize %}

{% block title %}‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ - MindVibe{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto px-4 py-8">
  <h1 class="text-3xl font-bold mb-6 text-pink-600 text-center">üõí ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h1>

  {% if cart_items %}
    <div class="overflow-x-auto">
      <table class="min-w-full bg-white shadow rounded-xl">
        <thead>
          <tr class="border-b bg-pink-50 text-pink-700">
            <th class="text-left px-4 py-3">‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</th>
            <th class="text-left px-4 py-3">‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏∏‡∏î</th>
            <th class="text-right px-4 py-3">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô</th>
            <th class="text-center px-4 py-3">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
            <th class="text-right px-4 py-3">‡∏£‡∏ß‡∏°</th>
            <th class="text-center px-4 py-3">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
          </tr>
        </thead>
        <tbody>
          {% for item in cart_items %}
          <tr class="border-b hover:bg-gray-50">
            <td class="px-4 py-3">
              {% if item.outfit.image %}
              <a href="{% url 'outfits:outfit-detail' item.outfit.pk %}">
                <img src="{{ item.outfit.image.url }}" alt="{{ item.outfit.name }}" class="h-16 rounded">
              </a>
              {% else %}
              (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ)
              {% endif %}
            </td>
            <td class="px-4 py-3">
              <a href="{% url 'outfits:outfit-detail' item.outfit.pk %}" class="text-pink-600 hover:underline">
                {{ item.outfit.name }}
              </a>
            </td>
            <td class="text-right px-4 py-3">{{ item.price_per_item|floatformat:2|intcomma }}</td>
            <td class="text-center px-4 py-3">
              <form method="post" action="{% url 'outfits:update_cart_item' item.outfit.id %}" class="flex justify-center items-center gap-2">
                {% csrf_token %}
                {{ item.update_form.quantity }}
                <button type="submit" class="text-sm px-2 py-1 bg-gray-100 hover:bg-gray-200 rounded">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï</button>
              </form>
            </td>
            <td class="text-right px-4 py-3">{{ item.total_price|floatformat:2|intcomma }}</td>
            <td class="text-center px-4 py-3">
              <form method="post" action="{% url 'outfits:remove_from_cart' item.outfit.id %}">
                {% csrf_token %}
                <button type="submit" class="text-red-600 hover:underline text-sm">‡∏•‡∏ö</button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
        <tfoot>
          <tr class="bg-gray-100 font-bold">
            <td colspan="4" class="text-right px-4 py-3">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°:</td>
            <td colspan="2" class="text-right px-4 py-3 text-pink-600">{{ total_cart_price|floatformat:2|intcomma }} ‡∏ö‡∏≤‡∏ó</td>
          </tr>
        </tfoot>
      </table>
    </div>

    <div class="mt-6 flex justify-between items-center">
      <a href="{% url 'outfits:outfit-list' %}" class="text-sm text-gray-600 hover:underline">‚Üê ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∏‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</a>
      <a href="{% url 'outfits:checkout' %}" class="bg-pink-600 text-white px-4 py-2 rounded hover:bg-pink-700">
        ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠
      </a>
    </div>

  {% else %}
    <div class="text-center py-12">
      <p class="text-lg text-gray-600">‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤</p>
      <a href="{% url 'outfits:outfit-list' %}" class="mt-4 inline-block bg-pink-600 text-white px-4 py-2 rounded hover:bg-pink-700">
        ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∏‡∏î‡πÄ‡∏•‡∏¢
      </a>
    </div>
  {% endif %}
</div>
{% endblock %}
