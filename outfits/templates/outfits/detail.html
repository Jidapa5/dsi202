{% extends 'outfits/base.html' %}
{% load humanize %}
{% load static %} {# ‡πÄ‡∏û‡∏¥‡πà‡∏° load static ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ #}

{% block title %}{{ outfit.name }} - MindVibe{% endblock %}

{% block content %}
<article class="outfit-detail-container" style="display: grid; grid-template-columns: 1fr 1.5fr; gap: 30px; margin-top: 20px;">
    <div class="outfit-image">
        {% if outfit.image %}
            <img src="{{ outfit.image.url }}" alt="{{ outfit.name }}" style="max-width: 100%; height: auto; border-radius: var(--border-radius); box-shadow: var(--shadow);">
        {% else %}
            <div style="height: 300px; background-color: #eee; display: flex; align-items: center; justify-content: center; color: grey; border-radius: var(--border-radius);">(‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û)</div>
        {% endif %}
    </div>
    <div class="outfit-details">
        <h2>{{ outfit.name }}</h2>
        {% if outfit.category %}
            <p style="font-size: 0.9em; color: grey; margin-bottom: 15px;">
                ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà: <a href="{% url 'outfits:outfits-by-category' outfit.category.slug %}">{{ outfit.category.name }}</a>
            </p>
        {% endif %}

        <p class="description" style="margin-bottom: 15px;">{{ outfit.description }}</p>
        <p class="price" style="font-size: 1.2em; font-weight: bold; color: var(--primary-color); margin-bottom: 10px;">
            ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏ä‡πà‡∏≤: <span class="price-value">{{ outfit.price|floatformat:2|intcomma }}</span> ‡∏ö‡∏≤‡∏ó/‡∏ß‡∏±‡∏ô
        </p>

         {# --- ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ä‡∏∏‡∏î (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ) --- #}
         {% if current_status_text %}
         <p style="margin-bottom: 20px;">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô:
             <span style="font-weight: bold; color: {% if current_status_text == '‡∏ß‡πà‡∏≤‡∏á' %}green{% else %}red{% endif %};">
                 {{ current_status_text }}
             </span>
         </p>
         {% endif %}


        {# --- ‡∏™‡πà‡∏ß‡∏ô Add to Cart --- #}
        <div class="add-to-cart-action">
             {% if outfit.is_active %}
                {# --- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á --- #}
                {% if outfit.id|stringformat:"s" in cart_outfit_ids %} {# ‡πÅ‡∏õ‡∏•‡∏á ID ‡πÄ‡∏õ‡πá‡∏ô string ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö #}
                     <p style="color: green; font-weight: bold;">‚úÖ ‡∏ä‡∏∏‡∏î‡∏ô‡∏µ‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß</p>
                     <a href="{% url 'outfits:cart_detail' %}" class="button secondary-button small-button" style="margin-top:10px;">‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</a>
                {% else %}
                    {# --- ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ä‡∏∏‡∏î '‡∏ß‡πà‡∏≤‡∏á' ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£) --- #}
                    {% if current_status_text == '‡∏ß‡πà‡∏≤‡∏á' %}
                        {# --- ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á --- #}
                        <form action="{% url 'outfits:add_to_cart' outfit.id %}" method="post">
                            {% csrf_token %}
                            {# --- ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á quantity input --- #}
                            {# {{ add_to_cart_form.quantity.label_tag }} #}
                            {# {{ add_to_cart_form.quantity }} #}
                            <input type="hidden" name="quantity" value="1"> {# ‡∏™‡πà‡∏á 1 ‡πÑ‡∏õ‡πÄ‡∏•‡∏¢ #}
                            <button type="submit" class="button primary-button add-cart-button">üõí ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</button>
                        </form>
                    {% else %}
                        {# <p style="color: red;">(‡∏ä‡∏∏‡∏î‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡πÄ‡∏ä‡πà‡∏≤‡∏≠‡∏¢‡∏π‡πà ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡πÑ‡∏î‡πâ)</p> #}
                         <button type="button" class="button primary-button" disabled>üõí ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</button>
                    {% endif %}
                {% endif %}
             {% else %}
                 <p style="color: red;">(‡∏ä‡∏∏‡∏î‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏ä‡πà‡∏≤‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ)</p>
             {% endif %}
        </div>

    </div>
</article>

{# --- ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ) --- #}
{% if related_outfits %}
    <section class="related-outfits" style="margin-top: 40px; padding-top: 20px; border-top: 1px solid #eee;">
        <h3>‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á</h3>
        <div class="outfit-grid"> {# ‡πÉ‡∏ä‡πâ grid layout ‡πÄ‡∏î‡∏¥‡∏° #}
            {% for related_outfit in related_outfits %}
                <article class="outfit-card">
                    <div class="outfit-image">
                        <a href="{% url 'outfits:outfit-detail' related_outfit.pk %}">
                        {% if related_outfit.image %}
                            <img src="{{ related_outfit.image.url }}" alt="{{ related_outfit.name }}">
                        {% else %}
                            <div class="outfit-card-no-image" style="height: 150px; display: flex; align-items: center; justify-content: center; background-color: #f0f0f0; color: grey;">(‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û)</div>
                        {% endif %}
                        </a>
                    </div>
                    <div class="outfit-card-body">
                        <h4 class="outfit-card-title"><a href="{% url 'outfits:outfit-detail' related_outfit.pk %}">{{ related_outfit.name }}</a></h4>
                        <p class="outfit-card-price">{{ related_outfit.price|floatformat:2|intcomma }} ‡∏ö‡∏≤‡∏ó/‡∏ß‡∏±‡∏ô</p>
                        {# ‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏∏‡πà‡∏° Add to cart ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡πá‡πÑ‡∏î‡πâ #}
                    </div>
                </article>
            {% endfor %}
        </div>
    </section>
{% endif %}

{% endblock %}